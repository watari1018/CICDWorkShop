#this is the name of the workflow

name: My first workflow

on:

  # any push will trigger this workflow

 push:
    branches: 
        - 'v[0-9]+.[0-9]+'

 

jobs:

  my_first_ci:

    #from this point onwards is ubuntu

    runs-on: ubuntu-latest
    
    steps:

      - name: Run Trivy vulnerability scanner in repo mode
        uses: aquasecurity/trivy-action@master
        with:
          scan-type: 'fs'
          ignore-unfixed: true
          format: 'table'
          output: 'trivy-results.txt'
          severity: 'CRITICAL'

      - uses: actions/checkout@v2
      - name: Slack Notification
        uses: rtCamp/action-slack-notify@v2
        env: 
          SLACK_WEBHOOK: ${{ secrets.HUANG_YONGFEI }}

      - name: Slack Notification
        uses: rtCamp/action-slack-notify@v2
        env:
            SLACK_CHANNEL: general
            SLACK_COLOR: ${{ job.status }} 
            SLACK_ICON: https://github.com/rtCamp.png?size=48
            SLACK_MESSAGE: 'Post Content :rocket:'
            SLACK_TITLE: Post Title
            SLACK_USERNAME: Huang YongFei
            SLACK_WEBHOOK: ${{ secrets.HUANG_YONGFEI }}
          